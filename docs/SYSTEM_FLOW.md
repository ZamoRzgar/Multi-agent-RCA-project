# AetherLog 2.0 - System Flow & Interactions

**Visual guide to how all components work together**

---

## ğŸ”„ Complete System Flow

### High-Level Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER INPUT                                â”‚
â”‚  "Analyze this HDFS failure log and find the root cause"        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   MULTI-AGENT RCA SYSTEM                         â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  STAGE 1: LOG PARSING                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ Log Parser Agent (Qwen2-7B)                      â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ Input:  Raw log text (2000 lines)               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ Output: 18 events, 11 entities, timeline        â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â”‚                                        â”‚
â”‚                         â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  STAGE 2: KNOWLEDGE RETRIEVAL                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ KG Retrieval Agent                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ Query:  "DataNode + Block + Replication"        â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ Output: 5 similar incidents, 3 causal paths     â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â”‚                                        â”‚
â”‚                         â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  STAGE 3: HYPOTHESIS GENERATION                        â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚Log Reasoner â”‚  â”‚KG Reasoner  â”‚  â”‚   Hybrid    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚(Mistral-7B) â”‚  â”‚(LLaMA2-7B)  â”‚  â”‚ (Qwen2-7B)  â”‚    â”‚    â”‚
â”‚  â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚    â”‚    â”‚
â”‚  â”‚  â”‚Hypothesis A â”‚  â”‚Hypothesis B â”‚  â”‚Hypothesis C â”‚    â”‚    â”‚
â”‚  â”‚  â”‚"Disk fail"  â”‚  â”‚"Network"    â”‚  â”‚"Disk fail"  â”‚    â”‚    â”‚
â”‚  â”‚  â”‚Score: 0.75  â”‚  â”‚Score: 0.82  â”‚  â”‚Score: 0.87  â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â”‚                                        â”‚
â”‚                         â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  STAGE 4: DEBATE & REFINEMENT                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ Judge Agent                                      â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ - Scores hypotheses                              â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ - Provides feedback                              â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ - Requests refinement                            â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ Debate Protocol (3 rounds)                       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ Round 1: Initial â†’ Feedback                      â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ Round 2: Refined â†’ Re-score                      â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ Round 3: Final â†’ Select winner                   â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â”‚                                        â”‚
â”‚                         â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  STAGE 5: FINAL SELECTION                              â”‚    â”‚
â”‚  â”‚  Winner: Hypothesis C (Hybrid, score 0.91)             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        OUTPUT                                    â”‚
â”‚  {                                                               â”‚
â”‚    "root_cause": "Disk failure on DataNode-03",                 â”‚
â”‚    "confidence": 0.91,                                           â”‚
â”‚    "explanation": "Analysis shows I/O errors...",                â”‚
â”‚    "evidence": ["Log line 45", "KG fact INC-001"],              â”‚
â”‚    "recommended_action": "Replace disk on DataNode-03"           â”‚
â”‚  }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Detailed Agent Interactions

### Interaction 1: Log Parser â†’ KG Retrieval

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Log Parser Agent    â”‚
â”‚                      â”‚
â”‚  Extracts:           â”‚
â”‚  - Events: 18        â”‚
â”‚  - Entities: 11      â”‚
â”‚  - Errors: 3         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Message:
           â”‚ {
           â”‚   "events": [...],
           â”‚   "entities": ["DataNode", "NameNode", "Block"],
           â”‚   "timeline": [...]
           â”‚ }
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ KG Retrieval Agent   â”‚
â”‚                      â”‚
â”‚  Queries Neo4j:      â”‚
â”‚  1. Similar incidentsâ”‚
â”‚  2. Causal paths     â”‚
â”‚  3. Entity context   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Returns:
           â”‚ {
           â”‚   "similar_incidents": [INC-001, INC-005],
           â”‚   "causal_paths": ["Diskâ†’Replicationâ†’Loss"],
           â”‚   "entity_facts": {...}
           â”‚ }
           â”‚
           â–¼
     [To Reasoners]
```

---

### Interaction 2: Reasoners â†’ Judge

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Log Reasoner â”‚  â”‚KG Reasoner  â”‚  â”‚   Hybrid    â”‚
â”‚             â”‚  â”‚             â”‚  â”‚             â”‚
â”‚Hypothesis A â”‚  â”‚Hypothesis B â”‚  â”‚Hypothesis C â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                â”‚                â”‚
       â”‚                â”‚                â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ All 3 hypotheses sent to Judge
                        â”‚
                        â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Judge Agent    â”‚
              â”‚                  â”‚
              â”‚  Evaluates:      â”‚
              â”‚  - Evidence      â”‚
              â”‚  - Logic         â”‚
              â”‚  - Completeness  â”‚
              â”‚  - Clarity       â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ Feedback:
                       â”‚ {
                       â”‚   "A": {score: 0.75, feedback: "Add KG context"},
                       â”‚   "B": {score: 0.82, feedback: "Check timeline"},
                       â”‚   "C": {score: 0.87, feedback: "Add disk metrics"}
                       â”‚ }
                       â”‚
                       â–¼
              [Back to Reasoners for refinement]
```

---

### Interaction 3: Debate Protocol Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DEBATE PROTOCOL                           â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ROUND 1: Initial Hypotheses                       â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  Reasoners generate â†’ Judge scores â†’ Feedback      â”‚    â”‚
â”‚  â”‚  A: 0.75  B: 0.82  C: 0.87                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â”‚                                   â”‚
â”‚                         â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  REFINEMENT: Agents improve based on feedback      â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  - A adds KG context                               â”‚    â”‚
â”‚  â”‚  - B adds temporal analysis                        â”‚    â”‚
â”‚  â”‚  - C adds disk metrics                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â”‚                                   â”‚
â”‚                         â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ROUND 2: Refined Hypotheses                       â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  Reasoners submit â†’ Judge re-scores                â”‚    â”‚
â”‚  â”‚  A': 0.80  B': 0.85  C': 0.91                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â”‚                                   â”‚
â”‚                         â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  CONVERGENCE CHECK                                 â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  if (max_score - min_score) < 0.05:                â”‚    â”‚
â”‚  â”‚      â†’ CONVERGED                                   â”‚    â”‚
â”‚  â”‚  elif round >= max_rounds:                         â”‚    â”‚
â”‚  â”‚      â†’ MAX ROUNDS REACHED                          â”‚    â”‚
â”‚  â”‚  else:                                             â”‚    â”‚
â”‚  â”‚      â†’ Continue to Round 3                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â”‚                                   â”‚
â”‚                         â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  FINAL SELECTION                                   â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  Winner: C' (Hybrid Reasoner, score 0.91)         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ Knowledge Graph Interactions

### KG Query Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  KG Retrieval Agent  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Query 1: Find Similar Incidents
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Neo4j Database                              â”‚
â”‚                                              â”‚
â”‚  MATCH (i:Incident)-[:CONTAINS]->(e:Event)  â”‚
â”‚  WHERE e.component IN ["DataNode"]          â”‚
â”‚  RETURN i, similarity_score                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Results: [INC-001, INC-005, INC-012]
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  KG Retrieval Agent  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Query 2: Find Causal Paths
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Neo4j Database                              â”‚
â”‚                                              â”‚
â”‚  MATCH path = (e1:Event)-[:CAUSES*1..5]->   â”‚
â”‚               (e2:Event)                     â”‚
â”‚  RETURN path                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Results: [
           â”‚   "DiskError â†’ ReplicationFail â†’ DataLoss",
           â”‚   "IOError â†’ BlockCorrupt â†’ UnderReplicated"
           â”‚ ]
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  KG Retrieval Agent  â”‚
â”‚                      â”‚
â”‚  Combines results    â”‚
â”‚  Returns to Reasonersâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Structures

### 1. Parsed Log Structure

```json
{
  "events": [
    {
      "id": "E1",
      "timestamp": "2025-12-05 10:00:00",
      "component": "DataNode",
      "action": "Block replication failed",
      "severity": "ERROR",
      "message": "Failed to replicate blk_123 to DataNode-03"
    }
  ],
  "entities": [
    {
      "name": "DataNode-03",
      "type": "component",
      "mentions": 5
    }
  ],
  "timeline": [
    {
      "time": "10:00:00",
      "event_id": "E1",
      "description": "Replication failure"
    }
  ],
  "error_messages": [
    "I/O error on disk /dev/sda1"
  ]
}
```

### 2. KG Retrieval Result

```json
{
  "similar_incidents": [
    {
      "incident_id": "INC-2024-001",
      "similarity_score": 0.87,
      "root_cause": "Disk failure",
      "resolution": "Replace disk",
      "timestamp": "2024-11-15",
      "matched_entities": ["DataNode", "Block"]
    }
  ],
  "causal_paths": [
    {
      "path": "DiskError â†’ ReplicationFailure â†’ DataLoss",
      "confidence": 0.85,
      "occurrences": 12
    }
  ],
  "entity_context": {
    "DataNode-03": {
      "past_failures": 3,
      "last_failure": "2024-12-01",
      "related_components": ["NameNode", "HDFS"]
    }
  }
}
```

### 3. Hypothesis Structure

```json
{
  "hypothesis_id": "H1",
  "agent": "Log Reasoner",
  "root_cause": "Disk failure on DataNode-03",
  "confidence": 0.85,
  "evidence": [
    {
      "type": "log",
      "source": "line 45",
      "content": "I/O error on /dev/sda1"
    },
    {
      "type": "kg",
      "source": "INC-2024-001",
      "content": "Similar disk failure pattern"
    }
  ],
  "reasoning_chain": [
    "Disk I/O error detected at 10:00:00",
    "Block replication failed at 10:00:05",
    "Under-replication triggered at 10:00:10",
    "Data loss risk identified"
  ],
  "recommended_action": "Replace disk on DataNode-03"
}
```

### 4. Judge Evaluation

```json
{
  "evaluation_id": "EVAL-R1",
  "round": 1,
  "hypotheses": [
    {
      "hypothesis_id": "H1",
      "agent": "Log Reasoner",
      "scores": {
        "evidence_support": 0.70,
        "logical_consistency": 0.80,
        "completeness": 0.75,
        "novelty": 0.70,
        "clarity": 0.80
      },
      "total_score": 0.75,
      "feedback": "Strong temporal analysis. Consider adding KG context for historical validation."
    }
  ],
  "ranking": ["H3", "H2", "H1"],
  "winner": "H3"
}
```

---

## ğŸ”§ Configuration Flow

### System Configuration

```yaml
# config/config.yaml

llm:
  backend: "ollama"
  models:
    log_parser: "qwen2:7b"
    log_reasoner: "mistral:7b"
    kg_reasoner: "llama2:7b"
    hybrid_reasoner: "qwen2:7b"
    judge: "qwen2:7b"
  
  parameters:
    temperature: 0.7
    max_tokens: 1000
    top_p: 0.9

neo4j:
  uri: "bolt://localhost:7687"
  username: "neo4j"
  password: "${NEO4J_PASSWORD}"
  database: "neo4j"

debate:
  max_rounds: 3
  convergence_threshold: 0.05
  timeout_per_round: 300  # seconds

agents:
  log_parser:
    temperature: 0.2  # Low for structured extraction
    max_tokens: 1500
  
  reasoners:
    temperature: 0.7  # Higher for creative reasoning
    max_tokens: 1000
  
  judge:
    temperature: 0.3  # Low for consistent scoring
    max_tokens: 800
```

---

## ğŸš€ Execution Flow

### CLI Command

```bash
python src/main.py \
  --input data/raw/hdfs_failure_001.log \
  --config config/config.yaml \
  --output results/hdfs_001_rca.json \
  --verbose
```

### Internal Execution

```python
# src/main.py

def main(input_file, config_file, output_file):
    # 1. Load configuration
    config = load_config(config_file)
    
    # 2. Initialize agents
    log_parser = LogParserAgent(config=config)
    kg_retrieval = KGRetrievalAgent(config=config)
    reasoners = [
        RCAReasonerAgent(focus="log", config=config),
        RCAReasonerAgent(focus="kg", config=config),
        RCAReasonerAgent(focus="hybrid", config=config)
    ]
    judge = JudgeAgent(config=config)
    
    # 3. Initialize debate protocol
    debate = DebateProtocol(reasoners, judge, config=config)
    
    # 4. Load log file
    raw_logs = load_file(input_file)
    
    # 5. Parse logs
    parsed_logs = log_parser.process({"raw_logs": raw_logs})
    
    # 6. Retrieve KG context
    kg_context = kg_retrieval.process(parsed_logs)
    
    # 7. Run debate
    result = debate.run(parsed_logs, kg_context)
    
    # 8. Save results
    save_results(result, output_file)
    
    return result
```

---

## ğŸ“ˆ Performance Metrics

### Timing Breakdown (Estimated)

```
Total Time: ~2-3 minutes per log case

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stage 1: Log Parsing       30s      â”‚
â”‚ Stage 2: KG Retrieval      15s      â”‚
â”‚ Stage 3: Hypothesis Gen    45s      â”‚
â”‚ Stage 4: Debate (3 rounds) 60s      â”‚
â”‚ Stage 5: Final Selection   10s      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Breakdown by agent:
- Log Parser:     30s (1 LLM call)
- KG Retrieval:   15s (Neo4j queries)
- Each Reasoner:  15s (3 x 15s = 45s parallel)
- Judge (3x):     20s (3 rounds x 7s)
- Total LLM calls: 13 (1 parser + 3x3 reasoners + 3 judge)
```

---

**For complete architecture details, see**: [ARCHITECTURE.md](ARCHITECTURE.md)  
**For project roadmap, see**: [PROJECT_ROADMAP.md](PROJECT_ROADMAP.md)
